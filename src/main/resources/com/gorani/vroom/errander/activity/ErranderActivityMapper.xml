<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gorani.vroom.errander.activity.ErranderActivityMapper">

    <!-- 일별 수익 합계 조회 -->
    <select id="getErranderActivities" resultType="com.gorani.vroom.errander.activity.ErranderActivityVO">
        SELECT
            DATE_FORMAT(updated_at, '%Y-%m-%d') as earn_date,
            SUM(reward_amount) as daily_earning
        FROM ERRANDS
        WHERE errander_id = #{erranderId}
          AND status = 'COMPLETED'
          AND YEAR(updated_at) = #{year}
          AND MONTH(updated_at) = #{month}
        GROUP BY DATE(updated_at)
        ORDER BY earn_date
    </select>

    <select id="getErranderDailyDetail"
            resultType="com.gorani.vroom.errand.post.ErrandListVO">
        SELECT
            errands_id,
            title,
            reward_amount,
            status,
            created_at,
            updated_at,
            dong_full_name
        FROM ERRANDS
        WHERE errander_id = #{erranderId}
          AND status = 'COMPLETED'
          AND DATE(updated_at) = #{date}
        ORDER BY updated_at
    </select>
</mapper>
